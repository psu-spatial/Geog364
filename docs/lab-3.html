<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Lab 3 | Geog-364: Introduction to R</title>
  <meta name="description" content="Lab 1 support guide" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Lab 3 | Geog-364: Introduction to R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lab 1 support guide" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Lab 3 | Geog-364: Introduction to R" />
  
  <meta name="twitter:description" content="Lab 1 support guide" />
  

<meta name="author" content="Helen Greatrex" />


<meta name="date" content="2020-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab-2.html"/>
<link rel="next" href="test-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="libs/Leaflet.Sync-0.0.5/L.Map.Sync.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GEOGRAPHY 364 2020</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Lab 1</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#why-is-this-class-in-r"><i class="fa fa-check"></i><b>1.1.1</b> Why is this class in R?</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#what-are-r-and-r-studio"><i class="fa fa-check"></i><b>1.1.2</b> What are R and R-studio?</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#what-are-r-markdown-r-shiny"><i class="fa fa-check"></i><b>1.1.3</b> What are R-Markdown &amp; R-Shiny?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-r-and-r-studio"><i class="fa fa-check"></i><b>1.2</b> Installing R and R-studio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#i-have-rr-studio-installed-already"><i class="fa fa-check"></i><b>1.2.1</b> I have R/R-studio installed already</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#installing-rr-studio-for-the-first-time"><i class="fa fa-check"></i><b>1.2.2</b> Installing R/R-studio for the first time</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i><b>1.3</b> Getting started</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#open-r-studio"><i class="fa fa-check"></i><b>1.3.1</b> Open R-studio</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#change-a-few-settings"><i class="fa fa-check"></i><b>1.3.2</b> Change a few settings</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#project"><i class="fa fa-check"></i><b>1.3.3</b> Create an R-project</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#lab-challenge-1"><i class="fa fa-check"></i><b>1.4</b> Lab challenge 1</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#r-coding-basics"><i class="fa fa-check"></i><b>1.5</b> R coding basics</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#basic-arithmatic"><i class="fa fa-check"></i><b>1.5.1</b> Basic arithmatic</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#comparing-things"><i class="fa fa-check"></i><b>1.5.2</b> Comparing things</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#variables-and-assignment"><i class="fa fa-check"></i><b>1.5.3</b> Variables and assignment</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#functions"><i class="fa fa-check"></i><b>1.5.4</b> Functions</a></li>
<li class="chapter" data-level="1.5.5" data-path="index.html"><a href="index.html#packages"><i class="fa fa-check"></i><b>1.5.5</b> Packages</a></li>
<li class="chapter" data-level="1.5.6" data-path="index.html"><a href="index.html#coding-help"><i class="fa fa-check"></i><b>1.5.6</b> Coding help</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#lab-challenge-2"><i class="fa fa-check"></i><b>1.6</b> Lab Challenge 2</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#create-a-r-markdown-document"><i class="fa fa-check"></i><b>1.7</b> Create a R-Markdown document</a><ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#what-is-markdown"><i class="fa fa-check"></i><b>1.7.1</b> What is markdown?</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#creating-a-notebook-document"><i class="fa fa-check"></i><b>1.7.2</b> Creating a notebook document</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#Format"><i class="fa fa-check"></i><b>1.7.3</b> Text formatting (in the white area)</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#friend"><i class="fa fa-check"></i><b>1.8</b> “Friendly text”</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#lab-challenge-3"><i class="fa fa-check"></i><b>1.9</b> Lab Challenge 3</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#online-courses-and-resources"><i class="fa fa-check"></i><b>1.10</b> Online courses and resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab-2.html"><a href="lab-2.html"><i class="fa fa-check"></i><b>2</b> Lab 2</a><ul>
<li class="chapter" data-level="2.1" data-path="lab-2.html"><a href="lab-2.html#Lab2learn"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="lab-2.html"><a href="lab-2.html#lab-set-up"><i class="fa fa-check"></i><b>2.2</b> Lab set-up</a><ul>
<li class="chapter" data-level="2.2.1" data-path="lab-2.html"><a href="lab-2.html#create-a-lab-2-project"><i class="fa fa-check"></i><b>2.2.1</b> Create a Lab 2 Project</a></li>
<li class="chapter" data-level="2.2.2" data-path="lab-2.html"><a href="lab-2.html#markdown-adding-a-theme"><i class="fa fa-check"></i><b>2.2.2</b> Markdown adding a theme</a></li>
<li class="chapter" data-level="2.2.3" data-path="lab-2.html"><a href="lab-2.html#installing-common-spatial-packages"><i class="fa fa-check"></i><b>2.2.3</b> Installing common spatial packages</a></li>
<li class="chapter" data-level="2.2.4" data-path="lab-2.html"><a href="lab-2.html#download-data-for-this-lab"><i class="fa fa-check"></i><b>2.2.4</b> Download data for this lab</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lab-2.html"><a href="lab-2.html#data.frames-and-summary-statistics"><i class="fa fa-check"></i><b>2.3</b> Data.frames and summary statistics</a><ul>
<li class="chapter" data-level="2.3.1" data-path="lab-2.html"><a href="lab-2.html#reading-in-your-first-file"><i class="fa fa-check"></i><b>2.3.1</b> Reading in your first file</a></li>
<li class="chapter" data-level="2.3.2" data-path="lab-2.html"><a href="lab-2.html#summarising-data"><i class="fa fa-check"></i><b>2.3.2</b> Summarising data</a></li>
<li class="chapter" data-level="2.3.3" data-path="lab-2.html"><a href="lab-2.html#selecting-columns-and-rows"><i class="fa fa-check"></i><b>2.3.3</b> Selecting columns and rows</a></li>
<li class="chapter" data-level="2.3.4" data-path="lab-2.html"><a href="lab-2.html#basic-plot"><i class="fa fa-check"></i><b>2.3.4</b> Basic plot</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="lab-2.html"><a href="lab-2.html#converting-to-spatial-data"><i class="fa fa-check"></i><b>2.4</b> Converting to spatial data</a><ul>
<li class="chapter" data-level="2.4.1" data-path="lab-2.html"><a href="lab-2.html#making-a-data.frame-spatial"><i class="fa fa-check"></i><b>2.4.1</b> Making a data.frame “spatial”</a></li>
<li class="chapter" data-level="2.4.2" data-path="lab-2.html"><a href="lab-2.html#reading-in-vector-line-data-rnaturalearth"><i class="fa fa-check"></i><b>2.4.2</b> Reading in vector line data (rnaturalearth)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lab-2.html"><a href="lab-2.html#assigning-a-map-projection"><i class="fa fa-check"></i><b>2.5</b> Assigning a map projection</a><ul>
<li class="chapter" data-level="2.5.1" data-path="lab-2.html"><a href="lab-2.html#checking-a-projection-in-the-sp-package"><i class="fa fa-check"></i><b>2.5.1</b> Checking a projection in the <strong>sp</strong> package</a></li>
<li class="chapter" data-level="2.5.2" data-path="lab-2.html"><a href="lab-2.html#assignchanging-projections-in-the-sp-package"><i class="fa fa-check"></i><b>2.5.2</b> Assign/changing projections in the sp package</a></li>
<li class="chapter" data-level="2.5.3" data-path="lab-2.html"><a href="lab-2.html#map-projections-in-the-sf-package"><i class="fa fa-check"></i><b>2.5.3</b> Map projections in the <strong>sf</strong> package</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="lab-2.html"><a href="lab-2.html#interactive-leaflet-plots"><i class="fa fa-check"></i><b>2.6</b> Interactive Leaflet plots</a></li>
<li class="chapter" data-level="2.7" data-path="lab-2.html"><a href="lab-2.html#describe-the-ghana-data"><i class="fa fa-check"></i><b>2.7</b> Describe the Ghana data</a></li>
<li class="chapter" data-level="2.8" data-path="lab-2.html"><a href="lab-2.html#show-me-something-new"><i class="fa fa-check"></i><b>2.8</b> Show me something new</a></li>
<li class="chapter" data-level="2.9" data-path="lab-2.html"><a href="lab-2.html#lab-submission-check"><i class="fa fa-check"></i><b>2.9</b> Lab submission check</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lab-3.html"><a href="lab-3.html"><i class="fa fa-check"></i><b>3</b> Lab 3</a><ul>
<li class="chapter" data-level="3.1" data-path="lab-3.html"><a href="lab-3.html#Lab3learn"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="lab-3.html"><a href="lab-3.html#lab-3-set-up"><i class="fa fa-check"></i><b>3.2</b> Lab 3 Set-Up</a><ul>
<li class="chapter" data-level="3.2.1" data-path="lab-3.html"><a href="lab-3.html#create-your-lab-3-project-file"><i class="fa fa-check"></i><b>3.2.1</b> Create your Lab 3 project file</a></li>
<li class="chapter" data-level="3.2.2" data-path="lab-3.html"><a href="lab-3.html#install-new-packages"><i class="fa fa-check"></i><b>3.2.2</b> Install new packages</a></li>
<li class="chapter" data-level="3.2.3" data-path="lab-3.html"><a href="lab-3.html#create-your-notebook-file"><i class="fa fa-check"></i><b>3.2.3</b> Create your NoteBook file</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="lab-3.html"><a href="lab-3.html#initial-data-exploration"><i class="fa fa-check"></i><b>3.3</b> Initial Data exploration</a><ul>
<li class="chapter" data-level="3.3.1" data-path="lab-3.html"><a href="lab-3.html#loading-the-data"><i class="fa fa-check"></i><b>3.3.1</b> Loading the data</a></li>
<li class="chapter" data-level="3.3.2" data-path="lab-3.html"><a href="lab-3.html#reading-more-information"><i class="fa fa-check"></i><b>3.3.2</b> Reading more information</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lab-3.html"><a href="lab-3.html#lab-3-challenge-1"><i class="fa fa-check"></i><b>3.4</b> Lab-3 Challenge 1</a></li>
<li class="chapter" data-level="3.5" data-path="lab-3.html"><a href="lab-3.html#mean-centre-and-standard-ellipse"><i class="fa fa-check"></i><b>3.5</b> Mean Centre and Standard Ellipse</a></li>
<li class="chapter" data-level="3.6" data-path="lab-3.html"><a href="lab-3.html#lab-3-challenge-2"><i class="fa fa-check"></i><b>3.6</b> Lab-3 Challenge 2</a></li>
<li class="chapter" data-level="3.7" data-path="lab-3.html"><a href="lab-3.html#global-density-analysis"><i class="fa fa-check"></i><b>3.7</b> Global Density analysis</a></li>
<li class="chapter" data-level="3.8" data-path="lab-3.html"><a href="lab-3.html#lab-3-challenge-3"><i class="fa fa-check"></i><b>3.8</b> Lab-3 Challenge 3</a></li>
<li class="chapter" data-level="3.9" data-path="lab-3.html"><a href="lab-3.html#local-intensity---quadrat-analysis"><i class="fa fa-check"></i><b>3.9</b> Local intensity - quadrat analysis</a></li>
<li class="chapter" data-level="3.10" data-path="lab-3.html"><a href="lab-3.html#lab-3-challenge-4"><i class="fa fa-check"></i><b>3.10</b> Lab-3 Challenge 4</a></li>
<li class="chapter" data-level="3.11" data-path="lab-3.html"><a href="lab-3.html#issues-with-quadrat-analysis"><i class="fa fa-check"></i><b>3.11</b> Issues with quadrat analysis</a></li>
<li class="chapter" data-level="3.12" data-path="lab-3.html"><a href="lab-3.html#lab-3-challenge-5"><i class="fa fa-check"></i><b>3.12</b> Lab-3 Challenge 5</a></li>
<li class="chapter" data-level="3.13" data-path="lab-3.html"><a href="lab-3.html#kernel-density-estimation-kde"><i class="fa fa-check"></i><b>3.13</b> Kernel Density Estimation (KDE)</a></li>
<li class="chapter" data-level="3.14" data-path="lab-3.html"><a href="lab-3.html#lab-3-challenge-6"><i class="fa fa-check"></i><b>3.14</b> Lab-3 Challenge 6</a></li>
<li class="chapter" data-level="3.15" data-path="lab-3.html"><a href="lab-3.html#automatically-calculating-an-optimal-bandwidth"><i class="fa fa-check"></i><b>3.15</b> Automatically calculating an “optimal” bandwidth</a></li>
<li class="chapter" data-level="3.16" data-path="lab-3.html"><a href="lab-3.html#lab-3-challenge-7"><i class="fa fa-check"></i><b>3.16</b> Lab-3 Challenge 7</a></li>
<li class="chapter" data-level="3.17" data-path="lab-3.html"><a href="lab-3.html#lab-3-show-me-something-new"><i class="fa fa-check"></i><b>3.17</b> Lab-3 Show me something new</a></li>
<li class="chapter" data-level="3.18" data-path="lab-3.html"><a href="lab-3.html#lab-3-submission-check"><i class="fa fa-check"></i><b>3.18</b> Lab-3 submission check</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="test-1.html"><a href="test-1.html"><i class="fa fa-check"></i><b>4</b> TEST 1</a><ul>
<li class="chapter" data-level="4.1" data-path="test-1.html"><a href="test-1.html#set-up-the-data"><i class="fa fa-check"></i><b>4.1</b> Set up the data</a></li>
<li class="chapter" data-level="4.2" data-path="test-1.html"><a href="test-1.html#lanternfly-analysis"><i class="fa fa-check"></i><b>4.2</b> Lanternfly analysis</a></li>
<li class="chapter" data-level="4.3" data-path="test-1.html"><a href="test-1.html#beetle-analysis"><i class="fa fa-check"></i><b>4.3</b> Beetle analysis</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lab-4.html"><a href="lab-4.html"><i class="fa fa-check"></i><b>5</b> Lab 4</a><ul>
<li class="chapter" data-level="5.1" data-path="lab-4.html"><a href="lab-4.html#lab-4-set-up"><i class="fa fa-check"></i><b>5.1</b> Lab 4 Set-Up</a><ul>
<li class="chapter" data-level="5.1.1" data-path="lab-4.html"><a href="lab-4.html#create-your-lab-4-project-file"><i class="fa fa-check"></i><b>5.1.1</b> Create your Lab 4 project file</a></li>
<li class="chapter" data-level="5.1.2" data-path="lab-3.html"><a href="lab-3.html#create-your-notebook-file"><i class="fa fa-check"></i><b>5.1.2</b> Create your NoteBook file</a></li>
<li class="chapter" data-level="5.1.3" data-path="lab-4.html"><a href="lab-4.html#download-and-run-packages"><i class="fa fa-check"></i><b>5.1.3</b> Download and run packages</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lab-4.html"><a href="lab-4.html#challenge-1-exploratory-analysis"><i class="fa fa-check"></i><b>5.2</b> Challenge 1, Exploratory analysis</a></li>
<li class="chapter" data-level="5.3" data-path="lab-4.html"><a href="lab-4.html#challenge-2-set-up-the-data"><i class="fa fa-check"></i><b>5.3</b> Challenge 2, set up the data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="lab-4.html"><a href="lab-4.html#a.-read-in-and-explore-the-point-data"><i class="fa fa-check"></i><b>5.3.1</b> A. Read in and explore the point data</a></li>
<li class="chapter" data-level="5.3.2" data-path="lab-4.html"><a href="lab-4.html#b.-read-in-the-other-data-and-set-projections"><i class="fa fa-check"></i><b>5.3.2</b> B. Read in the other data and set projections</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="lab-4.html"><a href="lab-4.html#challenge-3-make-data-ppp"><i class="fa fa-check"></i><b>5.4</b> Challenge 3, Make data ppp</a></li>
<li class="chapter" data-level="5.5" data-path="lab-4.html"><a href="lab-4.html#challenge-4-quadrat-analysis"><i class="fa fa-check"></i><b>5.5</b> Challenge 4, quadrat analysis</a></li>
<li class="chapter" data-level="5.6" data-path="lab-4.html"><a href="lab-4.html#challenge-5-elevation-links"><i class="fa fa-check"></i><b>5.6</b> Challenge 5, elevation links</a></li>
<li class="chapter" data-level="5.7" data-path="lab-4.html"><a href="lab-4.html#challenge-6-nearest-neighbour"><i class="fa fa-check"></i><b>5.7</b> Challenge 6 Nearest neighbour</a></li>
<li class="chapter" data-level="5.8" data-path="lab-4.html"><a href="lab-4.html#challenge-7-l-analysis"><i class="fa fa-check"></i><b>5.8</b> Challenge 7 L Analysis</a></li>
<li class="chapter" data-level="5.9" data-path="lab-4.html"><a href="lab-4.html#challenge-8-show-me-something-new"><i class="fa fa-check"></i><b>5.9</b> Challenge 8 Show me something new</a></li>
<li class="chapter" data-level="5.10" data-path="lab-4.html"><a href="lab-4.html#lab-4-submission-check"><i class="fa fa-check"></i><b>5.10</b> Lab-4 submission check</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lab-5.html"><a href="lab-5.html"><i class="fa fa-check"></i><b>6</b> Lab 5</a><ul>
<li class="chapter" data-level="6.1" data-path="lab-5.html"><a href="lab-5.html#lab-5-set-up"><i class="fa fa-check"></i><b>6.1</b> Lab 5 Set-Up</a><ul>
<li class="chapter" data-level="6.1.1" data-path="lab-5.html"><a href="lab-5.html#create-your-lab-5-project-file"><i class="fa fa-check"></i><b>6.1.1</b> Create your Lab 5 project file</a></li>
<li class="chapter" data-level="6.1.2" data-path="lab-3.html"><a href="lab-3.html#create-your-notebook-file"><i class="fa fa-check"></i><b>6.1.2</b> Create your NoteBook file</a></li>
<li class="chapter" data-level="6.1.3" data-path="lab-5.html"><a href="lab-5.html#style-guide"><i class="fa fa-check"></i><b>6.1.3</b> Style guide</a></li>
<li class="chapter" data-level="6.1.4" data-path="lab-4.html"><a href="lab-4.html#download-and-run-packages"><i class="fa fa-check"></i><b>6.1.4</b> Download and run packages</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="lab-5.html"><a href="lab-5.html#challenge-1-explore-the-data"><i class="fa fa-check"></i><b>6.2</b> Challenge 1: Explore the data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="lab-5.html"><a href="lab-5.html#download-load-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Download &amp; load the data</a></li>
<li class="chapter" data-level="6.2.2" data-path="lab-5.html"><a href="lab-5.html#initial-analysis"><i class="fa fa-check"></i><b>6.2.2</b> Initial analysis</a></li>
<li class="chapter" data-level="6.2.3" data-path="lab-5.html"><a href="lab-5.html#convert-to-spatial-data"><i class="fa fa-check"></i><b>6.2.3</b> Convert to spatial data</a></li>
<li class="chapter" data-level="6.2.4" data-path="lab-5.html"><a href="lab-5.html#add-a-projection"><i class="fa fa-check"></i><b>6.2.4</b> Add a projection</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lab-5.html"><a href="lab-5.html#challenge-2-exploratory-analysis"><i class="fa fa-check"></i><b>6.3</b> Challenge 2: Exploratory analysis</a><ul>
<li class="chapter" data-level="6.3.1" data-path="lab-5.html"><a href="lab-5.html#make-plots-in-tmap"><i class="fa fa-check"></i><b>6.3.1</b> Make plots in tmap</a></li>
<li class="chapter" data-level="6.3.2" data-path="lab-5.html"><a href="lab-5.html#exploratory-analysis"><i class="fa fa-check"></i><b>6.3.2</b> Exploratory analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lab-5.html"><a href="lab-5.html#challenge-3-thiessen-polygons-by-hand"><i class="fa fa-check"></i><b>6.4</b> Challenge 3: Thiessen polygons by hand</a></li>
<li class="chapter" data-level="6.5" data-path="lab-5.html"><a href="lab-5.html#challenge-4-thiessen-polygons-in-r"><i class="fa fa-check"></i><b>6.5</b> Challenge 4: Thiessen polygons in R</a></li>
<li class="chapter" data-level="6.6" data-path="lab-5.html"><a href="lab-5.html#challenge-5-inverse-distance-weighting-info"><i class="fa fa-check"></i><b>6.6</b> Challenge 5: Inverse Distance Weighting info</a></li>
<li class="chapter" data-level="6.7" data-path="lab-5.html"><a href="lab-5.html#challenge-6-inverse-distance-weighting-code"><i class="fa fa-check"></i><b>6.7</b> Challenge 6: Inverse Distance Weighting code</a></li>
<li class="chapter" data-level="6.8" data-path="lab-5.html"><a href="lab-5.html#challenge-7-checking-accuracy"><i class="fa fa-check"></i><b>6.8</b> Challenge 7: Checking accuracy</a></li>
<li class="chapter" data-level="6.9" data-path="lab-5.html"><a href="lab-5.html#challenge-8-your-own-idw"><i class="fa fa-check"></i><b>6.9</b> Challenge 8: Your own IDW</a></li>
<li class="chapter" data-level="6.10" data-path="lab-5.html"><a href="lab-5.html#challenge-9-show-me-something-new"><i class="fa fa-check"></i><b>6.10</b> Challenge 9 Show me something new</a></li>
<li class="chapter" data-level="6.11" data-path="lab-5.html"><a href="lab-5.html#lab-5-submission-check"><i class="fa fa-check"></i><b>6.11</b> Lab-5 submission check</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lab-6.html"><a href="lab-6.html"><i class="fa fa-check"></i><b>7</b> Lab 6</a><ul>
<li class="chapter" data-level="7.1" data-path="lab-6.html"><a href="lab-6.html#lab-6-set-up"><i class="fa fa-check"></i><b>7.1</b> Lab 6 Set-Up</a><ul>
<li class="chapter" data-level="7.1.1" data-path="lab-6.html"><a href="lab-6.html#create-your-lab-6-project-file"><i class="fa fa-check"></i><b>7.1.1</b> Create your Lab 6 project file</a></li>
<li class="chapter" data-level="7.1.2" data-path="lab-3.html"><a href="lab-3.html#create-your-notebook-file"><i class="fa fa-check"></i><b>7.1.2</b> Create your NoteBook file</a></li>
<li class="chapter" data-level="7.1.3" data-path="lab-5.html"><a href="lab-5.html#style-guide"><i class="fa fa-check"></i><b>7.1.3</b> Style guide</a></li>
<li class="chapter" data-level="7.1.4" data-path="lab-4.html"><a href="lab-4.html#download-and-run-packages"><i class="fa fa-check"></i><b>7.1.4</b> Download and run packages</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="lab-6.html"><a href="lab-6.html#tutorial-1-spatial-weights-and-join-counts"><i class="fa fa-check"></i><b>7.2</b> Tutorial 1: Spatial weights and Join Counts</a><ul>
<li class="chapter" data-level="7.2.1" data-path="lab-6.html"><a href="lab-6.html#making-the-grid"><i class="fa fa-check"></i><b>7.2.1</b> Making the grid</a></li>
<li class="chapter" data-level="7.2.2" data-path="lab-6.html"><a href="lab-6.html#creating-the-spatial-weights"><i class="fa fa-check"></i><b>7.2.2</b> Creating the spatial weights</a></li>
<li class="chapter" data-level="7.2.3" data-path="lab-6.html"><a href="lab-6.html#conducting-a-join-counts-analysis"><i class="fa fa-check"></i><b>7.2.3</b> Conducting a join-counts analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="lab-6.html"><a href="lab-6.html#challenge-1-join-counts"><i class="fa fa-check"></i><b>7.3</b> Challenge 1: Join Counts</a><ul>
<li class="chapter" data-level="7.3.1" data-path="lab-6.html"><a href="lab-6.html#challenge-1a"><i class="fa fa-check"></i><b>7.3.1</b> Challenge 1a</a></li>
<li class="chapter" data-level="7.3.2" data-path="lab-6.html"><a href="lab-6.html#challenge-1b"><i class="fa fa-check"></i><b>7.3.2</b> Challenge 1b</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="lab-6.html"><a href="lab-6.html#tutorial-2-social-vulnerability-and-morans-i"><i class="fa fa-check"></i><b>7.4</b> Tutorial 2: Social vulnerability and Moran’s I</a><ul>
<li class="chapter" data-level="7.4.1" data-path="lab-6.html"><a href="lab-6.html#download-the-data"><i class="fa fa-check"></i><b>7.4.1</b> Download the data</a></li>
<li class="chapter" data-level="7.4.2" data-path="lab-6.html"><a href="lab-6.html#read-the-data-into-r"><i class="fa fa-check"></i><b>7.4.2</b> Read the data into R</a></li>
<li class="chapter" data-level="7.4.3" data-path="lab-6.html"><a href="lab-6.html#change-the-projection"><i class="fa fa-check"></i><b>7.4.3</b> Change the projection</a></li>
<li class="chapter" data-level="7.4.4" data-path="lab-6.html"><a href="lab-6.html#explore-the-data"><i class="fa fa-check"></i><b>7.4.4</b> Explore the data</a></li>
<li class="chapter" data-level="7.4.5" data-path="lab-6.html"><a href="lab-6.html#creating-a-spatial-weights-matrix"><i class="fa fa-check"></i><b>7.4.5</b> Creating a spatial weights matrix</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="lab-6.html"><a href="lab-6.html#challenge-2-your-own-spatial-analysis"><i class="fa fa-check"></i><b>7.5</b> Challenge 2: Your own spatial analysis</a></li>
<li class="chapter" data-level="7.6" data-path="lab-6.html"><a href="lab-6.html#lab-6-show-me-something-new"><i class="fa fa-check"></i><b>7.6</b> Lab 6 Show me something new</a></li>
<li class="chapter" data-level="7.7" data-path="lab-6.html"><a href="lab-6.html#lab-6-submission-check"><i class="fa fa-check"></i><b>7.7</b> Lab-6 submission check</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lab-7.html"><a href="lab-7.html"><i class="fa fa-check"></i><b>8</b> Lab 7</a><ul>
<li class="chapter" data-level="8.1" data-path="lab-7.html"><a href="lab-7.html#lab-7-set-up"><i class="fa fa-check"></i><b>8.1</b> Lab 7 Set-Up</a><ul>
<li class="chapter" data-level="8.1.1" data-path="lab-7.html"><a href="lab-7.html#create-your-lab-7-project-file"><i class="fa fa-check"></i><b>8.1.1</b> Create your Lab 7 project file</a></li>
<li class="chapter" data-level="8.1.2" data-path="lab-3.html"><a href="lab-3.html#create-your-notebook-file"><i class="fa fa-check"></i><b>8.1.2</b> Create your NoteBook file</a></li>
<li class="chapter" data-level="8.1.3" data-path="lab-5.html"><a href="lab-5.html#style-guide"><i class="fa fa-check"></i><b>8.1.3</b> Style guide</a></li>
<li class="chapter" data-level="8.1.4" data-path="lab-4.html"><a href="lab-4.html#download-and-run-packages"><i class="fa fa-check"></i><b>8.1.4</b> Download and run packages</a></li>
<li class="chapter" data-level="8.1.5" data-path="lab-7.html"><a href="lab-7.html#sign-up-for-census-api"><i class="fa fa-check"></i><b>8.1.5</b> Sign up for Census API</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="lab-7.html"><a href="lab-7.html#tutorial-1-data-wrangling"><i class="fa fa-check"></i><b>8.2</b> Tutorial 1: Data Wrangling</a><ul>
<li class="chapter" data-level="8.2.1" data-path="lab-7.html"><a href="lab-7.html#loading-census-data-from-tidycensus"><i class="fa fa-check"></i><b>8.2.1</b> Loading census data from tidycensus</a></li>
<li class="chapter" data-level="8.2.2" data-path="lab-7.html"><a href="lab-7.html#re-arranging-the-data"><i class="fa fa-check"></i><b>8.2.2</b> Re-arranging the data</a></li>
<li class="chapter" data-level="8.2.3" data-path="lab-7.html"><a href="lab-7.html#converting-totals-to-percentages-densities"><i class="fa fa-check"></i><b>8.2.3</b> Converting totals to percentages / densities</a></li>
<li class="chapter" data-level="8.2.4" data-path="lab-7.html"><a href="lab-7.html#plotting-the-data"><i class="fa fa-check"></i><b>8.2.4</b> Plotting the data</a></li>
<li class="chapter" data-level="8.2.5" data-path="lab-7.html"><a href="lab-7.html#zooming-in"><i class="fa fa-check"></i><b>8.2.5</b> Zooming in</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="lab-7.html"><a href="lab-7.html#challenge-1"><i class="fa fa-check"></i><b>8.3</b> Challenge 1</a></li>
<li class="chapter" data-level="8.4" data-path="lab-7.html"><a href="lab-7.html#tutorial-2-regression"><i class="fa fa-check"></i><b>8.4</b> Tutorial 2 Regression</a><ul>
<li class="chapter" data-level="8.4.1" data-path="lab-7.html"><a href="lab-7.html#basics"><i class="fa fa-check"></i><b>8.4.1</b> Basics</a></li>
<li class="chapter" data-level="8.4.2" data-path="lab-7.html"><a href="lab-7.html#basic-regression"><i class="fa fa-check"></i><b>8.4.2</b> Basic regression</a></li>
<li class="chapter" data-level="8.4.3" data-path="lab-7.html"><a href="lab-7.html#spatial-residuals"><i class="fa fa-check"></i><b>8.4.3</b> Spatial residuals</a></li>
<li class="chapter" data-level="8.4.4" data-path="lab-7.html"><a href="lab-7.html#spatial-lag-model"><i class="fa fa-check"></i><b>8.4.4</b> Spatial lag model</a></li>
<li class="chapter" data-level="8.4.5" data-path="lab-7.html"><a href="lab-7.html#plotting-the-results"><i class="fa fa-check"></i><b>8.4.5</b> Plotting the results</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="lab-7.html"><a href="lab-7.html#challenge-2"><i class="fa fa-check"></i><b>8.5</b> Challenge 2</a></li>
<li class="chapter" data-level="8.6" data-path="lab-7.html"><a href="lab-7.html#lab-7-show-me-something-new"><i class="fa fa-check"></i><b>8.6</b> Lab 7 Show me something new</a></li>
<li class="chapter" data-level="8.7" data-path="lab-7.html"><a href="lab-7.html#lab-7-submission-check"><i class="fa fa-check"></i><b>8.7</b> Lab-7 submission check</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Geog-364: Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab-3" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Lab 3</h1>
<div id="Lab3learn" class="section level2">
<h2><span class="header-section-number">3.1</span> Learning objectives</h2>
<p>Welcome to Lab 3, where we are going to focus on Point Pattern Analysis. A point pattern dataset events or objects occurring in a defined study region. These events could represent anything with a specific measurable location, from greenhouses to stars.</p>
<p><strong>Objective:</strong> The goal of Lab 3 is to learn some introductory spatial statistical approaches for characterizing first-order properties of a point pattern. We will be focusing on quadrat analysis, kernal analysis and standard ellipses.</p>
<p><strong>Data-sets:</strong> You will be working with two separate point pattern datasets that are already built into R.</p>
<ul>
<li>The first dataset, called longleaf pine, is a marked point pattern containing locations and diameter measurements of longleaf pint trees in a forest in Georgia. All your examples here in this lab book will analyse this dataset.</li>
<li>The second dataset is called bei and is also related to trees. You will be analysing this one and will find out more as you go</li>
</ul>
<div class="figure"><span id="fig:ppp0"></span>
<img src="images/Fig_3_00ppp.jpg" alt="The two point datasets we are exploring" width="280" />
<p class="caption">
Figure 3.1: The two point datasets we are exploring
</p>
</div>
</div>
<div id="lab-3-set-up" class="section level2">
<h2><span class="header-section-number">3.2</span> Lab 3 Set-Up</h2>
<div id="create-your-lab-3-project-file" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Create your Lab 3 project file</h3>
<p>Open a new version of R-studio. Click the file menu, then new project in a new directory. Select your 364 directory, then name the project Lab 3. If you are stuck on this process, see the start of Lab 1 and Lab 2.</p>
<p>You can check this has worked by looking on the file explorer on your computer, then selecting your GEOG364 folder and checking that a Lab 3 folder has appeared with your Lab3.Proj file inside it.</p>
</div>
<div id="install-new-packages" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Install new packages</h3>
<p>There are two specialist packages called “spatstat” and “car” which focus on point pattern analysis.</p>
<div id="install-the-spatstat-package" class="section level4">
<h4><span class="header-section-number">3.2.2.1</span> Install the spatstat package</h4>
<p>To make sure you do not include the install.packages command in your .Rmd file, please install it by clicking the “install button” in the packages menu. Click on the install button, then start typing spatstat,select it and press install.</p>
<p><em>If you are a Windows user, you will see a message at the beginning of the install process saying that you need to install R-Tools. IGNORE THIS - You probably don’t need to install R-Tools </em></p>
<div class="figure"><span id="fig:installbutton3"></span>
<img src="images/Fig_3_01_install.png" alt="You can click the button and simply type the name if the package you want to install" width="914" />
<p class="caption">
Figure 3.2: You can click the button and simply type the name if the package you want to install
</p>
</div>
<p>The install might take a few minutes. Once it has finished, test it has worked by typing <code>library(spatstat)</code> into the console. you should see some messages like this.</p>
<div class="figure"><span id="fig:spatstat3"></span>
<img src="images/Fig_3_02spatstat_library.png" alt="The messages that appear when I load spatstat for the first time" width="659" />
<p class="caption">
Figure 3.3: The messages that appear when I load spatstat for the first time
</p>
</div>
<p>There is a lot of text, but unless you have a load of things that say ERROR, you can ignore it. (Don’t worry about the out of date message). One way to check is to run the code chunk twice as shown in the screenshot. If the second time the messages disappear then you don’t need to worry.</p>
<p>IF THIS PACKAGE HASN’T LOADED OR INSTALLED CORRECTLY, TALK TO AN INSTRUCTOR.</p>
</div>
<div id="install-the-car-package" class="section level4">
<h4><span class="header-section-number">3.2.2.2</span> Install the car package</h4>
<p>Now, repeat the process for the <code>car</code> package. This might take a while to download. You should see something like this.</p>
<div class="figure"><span id="fig:car3"></span>
<img src="images/Fig_3_03Car.png" alt="The messages that appear when I load car for the first time" width="497" />
<p class="caption">
Figure 3.4: The messages that appear when I load car for the first time
</p>
</div>
<p>IF THIS PACKAGE HASN’T LOADED OR INSTALLED CORRECTLY, TALK TO AN INSTRUCTOR.</p>
</div>
</div>
<div id="create-your-notebook-file" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Create your NoteBook file</h3>
<ol style="list-style-type: decimal">
<li><p>Now, go to File/New File and create a new R-NOTEBOOK file.</p></li>
<li><p>Delete the friendly text (everything from line 6 onward)</p></li>
<li><p>Save your file as <code>GEOG364_Lab3_PSU.ID.Rmd</code> e.g. <code>GEOG364_Lab3_hlg5155.Rmd</code></p></li>
<li><p>Follow Section 2.2.2 to modify your YAML code (you can keep lumen as a theme or try your own)</p></li>
<li><p>Add a new code chunk. Inside add the following code and run it.</p></li>
</ol>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="lab-3.html#cb67-1"></a><span class="kw">library</span>(spatstat)</span>
<span id="cb67-2"><a href="lab-3.html#cb67-2"></a><span class="kw">library</span>(sp)</span>
<span id="cb67-3"><a href="lab-3.html#cb67-3"></a><span class="kw">library</span>(car)</span></code></pre></div>
<p>The reason we are adding this just after typing it into your console is that these library commands need to be run every time you open R. So we put them in a code chunk right at the top of your Note Book file.</p>
<p>Now click the Preview Button and make sure everything looks correct.</p>
<p>IF THERE ARE PROBLEMS, TALK TO AN INSTRUCTOR</p>
</div>
</div>
<div id="initial-data-exploration" class="section level2">
<h2><span class="header-section-number">3.3</span> Initial Data exploration</h2>
<div id="loading-the-data" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Loading the data</h3>
<p>In this lab, we are going to use two datasets that are already built into the spatstat package.</p>
<ul>
<li>All of the examples in this lab book are based on a dataset called <code>longleaf</code></li>
<li>You will be conducting your analysis on a dataset called <code>bei</code></li>
</ul>
<p>The advantage of this is that we don’t have to worry about file formats or Map Projections for now.</p>
<p>But first, we need to load them into R studio</p>
<p>Below your code chunk, make a new heading called Initial Data Analysis. Remember to leave a blank white line before and after your headings. If you can’t remember how to do this, go to <code>Help/Markdown Quick Reference</code> (where Help is the menu right at the top of your computer screen) or see Lab 1 or 2.</p>
<p>Now make a new code chunk. Inside add:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="lab-3.html#cb68-1"></a><span class="co"># This loads the internal dataset from R.</span></span>
<span id="cb68-2"><a href="lab-3.html#cb68-2"></a><span class="kw">data</span>(longleaf)</span>
<span id="cb68-3"><a href="lab-3.html#cb68-3"></a><span class="kw">data</span>(bei)</span></code></pre></div>
<p>Run the code chunk and you should see the longleaf and bei datasets appear in your environment quadrant on the screen (top right).</p>
<p>From now onward, you do not have to run the longleaf examples because you can see the output in this lab script, but the data is there if you want to test examples.</p>
<p><strong>Your job is to understand the <code>bei</code> dataset.</strong></p>
</div>
<div id="reading-more-information" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Reading more information</h3>
<p>Because the longleaf and bei datasets are internal, they have their own help file. To view the help file for the longleaf data, I create a new code chunk, and run the command:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="lab-3.html#cb69-1"></a><span class="co"># putting a ? at the start means look at the help file</span></span>
<span id="cb69-2"><a href="lab-3.html#cb69-2"></a><span class="co"># this will only work for commands and data built into R.</span></span>
<span id="cb69-3"><a href="lab-3.html#cb69-3"></a>?longleaf  </span></code></pre></div>
<p>The help file now opens onto my screen:</p>
<div class="figure"><span id="fig:helpfile3"></span>
<img src="images/Fig_3_04Helpfile.png" alt="The longleaf help file" width="979" />
<p class="caption">
Figure 3.5: The longleaf help file
</p>
</div>
<p>We can see a lot of information from this file:</p>
<ul>
<li>My data is a point pattern dataset containing locations and diameter measurements of longleaf pint trees in a US forest in Georgia</li>
<li>There are 586 pine trees in the dataset</li>
<li>The data was collected and analysed by Platt, Evans and Rathbun in 1988</li>
<li>The data is <em>marked</em>. So it is not just locations, but it also contains additional information about the diameter of each tree trunk (in cm).</li>
<li>The data is stored as a “ppp” object (which is a point pattern file type)</li>
<li>The ppp object also contains information on the region (i.e., window) that was chosen for the study. In this case it is a rectangle with an X coordinate range of 0-200 and a Y coordinate range of 0-200, with units in meters.</li>
</ul>
<p>I then made an initial plot of the longleaf data. Because the data is marked, the size of the circle automatically corresponds to the marks, the diameter of the tree trunk.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="lab-3.html#cb70-1"></a><span class="kw">plot</span>(longleaf)</span></code></pre></div>
<p><img src="GEOG364Labs_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
</div>
<div id="lab-3-challenge-1" class="section level2">
<h2><span class="header-section-number">3.4</span> Lab-3 Challenge 1</h2>
<ol style="list-style-type: decimal">
<li><p>Make sure you have a code chunk that loads the packages using library, AND one that loads the data using the data commnd. If not, go back and reread the section.</p></li>
<li><p>In a new code chunk, use the instructions above to load the help file for the <code>bei</code> data. Understand what the data is, how much data there is and whether it is marked. You are welcome to write notes here, but you will be assessed on your knowledge of this in the Canvas lab-3 quiz Q1 and Q2.</p></li>
<li><p>Create a new code chunk and make a plot of the <code>bei</code> data. Comment underneath the plot about whether you see any spatial autocorrelation (positive/negative/zero), plus which spatial fallacies might cause problems in this lab.</p></li>
</ol>
</div>
<div id="mean-centre-and-standard-ellipse" class="section level2">
<h2><span class="header-section-number">3.5</span> Mean Centre and Standard Ellipse</h2>
<p>Firstly, let’s look at some summary statistics. The easiest thing to consider is the spatial mean, where we take the mean of all the x values vs all the y values.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="lab-3.html#cb71-1"></a>x.mean.longleaf &lt;-<span class="st"> </span><span class="kw">mean</span>(longleaf<span class="op">$</span>x) </span>
<span id="cb71-2"><a href="lab-3.html#cb71-2"></a>y.mean.longleaf &lt;-<span class="st"> </span><span class="kw">mean</span>(longleaf<span class="op">$</span>y)</span>
<span id="cb71-3"><a href="lab-3.html#cb71-3"></a></span>
<span id="cb71-4"><a href="lab-3.html#cb71-4"></a><span class="kw">print</span>(x.mean.longleaf)</span></code></pre></div>
<pre><code>## [1] 98.73527</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="lab-3.html#cb73-1"></a><span class="kw">print</span>(y.mean.longleaf)</span></code></pre></div>
<pre><code>## [1] 113.8293</code></pre>
<p>We can also add a standard ellipse using the dataEllipse command in the <code>car</code> package.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="lab-3.html#cb75-1"></a><span class="kw">dataEllipse</span>(longleaf<span class="op">$</span>x, longleaf<span class="op">$</span>y, <span class="dt">levels=</span><span class="fl">0.68</span>, </span>
<span id="cb75-2"><a href="lab-3.html#cb75-2"></a>            <span class="dt">fill=</span><span class="ot">TRUE</span>, <span class="dt">fill.alpha=</span><span class="fl">0.1</span>, <span class="co"># Fill the ellipse with transparent grey</span></span>
<span id="cb75-3"><a href="lab-3.html#cb75-3"></a>            <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span>.<span class="dv">5</span>,            <span class="co"># filled small dots</span></span>
<span id="cb75-4"><a href="lab-3.html#cb75-4"></a>            <span class="dt">xlab=</span><span class="st">&quot;x (m)&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;y (m)&quot;</span>,         <span class="co"># labels</span></span>
<span id="cb75-5"><a href="lab-3.html#cb75-5"></a>            <span class="dt">col=</span> <span class="kw">c</span>(<span class="kw">rgb</span>(<span class="dt">red=</span><span class="dv">0</span>, <span class="dt">green=</span><span class="dv">0</span>, <span class="dt">blue=</span><span class="dv">0</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>),<span class="st">&quot;blue&quot;</span>)) <span class="co"># Slightly transparent points &amp; blue ellipse</span></span></code></pre></div>
<p><img src="GEOG364Labs_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>The reason this is often useful is that we can see if the overall distribution changes over time e.g. imagine repeating your survey of longleaf pines in 10yrs time and seeing if the distribution has changed with climate change or urbanization.</p>
</div>
<div id="lab-3-challenge-2" class="section level2">
<h2><span class="header-section-number">3.6</span> Lab-3 Challenge 2</h2>
<ol style="list-style-type: decimal">
<li><p>Make a new heading called Standard Ellipse</p></li>
<li><p>Make a new code chunk and find the spatial mean of the <code>bei</code> data</p></li>
<li><p>Create a new code chunk and plot the standard ellipse of the <code>bei</code> data.</p></li>
</ol>
<p>This corresponds with questions 3 and 4 in the Canvas Lab 3 quiz.</p>
</div>
<div id="global-density-analysis" class="section level2">
<h2><span class="header-section-number">3.7</span> Global Density analysis</h2>
<p>Let’s move beyond summary statistics. In the rest of this Lab, we will study the variation of the observations’ <em>density</em> across a study area, essentially giving us clues about the non-uniformity of space</p>
<p>For example, the distribution of trees might vary across a landscape from North to South due to climate conditions, or show a more complex spatial pattern based on underlying soil characteristics. These underlying factors could easily result in some areas having dense clusters of trees and other areas causing clearings.</p>
<p>This phenomenon is called <strong>First order</strong> spatial variation. AKA the underlying geography is causing the patterns we see (rather than a each individual point influencing the other points around it)</p>
<div class="figure"><span id="fig:autocorr3"></span>
<img src="images/Fig_3_05autocorrelation.png" alt="plot from " width="728" />
<p class="caption">
Figure 3.6: plot from
</p>
</div>
<p>The first way to look at this is to examine the overall density of points over the entire field, known as the global intensity. This is simply the average number of points per grid-cell. We say it’s “global” because we only calculate one number for the entire study area.</p>
<p>Mathematically, the overall intensity of a point process can be calculated via the following equation, where n is the number of points within our region and A is the area of the region.</p>
<p><span class="math display">\[\lambda=\frac{n}{A}\]</span></p>
<p>In R, we can do this simply by looking at the summary command. For the longleaf data, I am going to make a new code chunk and run</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="lab-3.html#cb76-1"></a><span class="kw">summary</span>(longleaf)</span></code></pre></div>
<pre><code>## Marked planar point pattern:  584 points
## Average intensity 0.0146 points per square metre
## 
## Coordinates are given to 1 decimal place
## i.e. rounded to the nearest multiple of 0.1 metres
## 
## marks are numeric, of type &#39;double&#39;
## Summary:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    2.00    9.10   26.15   26.84   42.12   75.90 
## 
## Window: rectangle = [0, 200] x [0, 200] metres
## Window area = 40000 square metres
## Unit of length: 1 metre</code></pre>
<p>Where we can see:</p>
<ul>
<li>That the global intensity of the pattern is 0.0146 trees per square metre (note the units).</li>
<li>This also gives us a summary of some information from the help file</li>
<li>It also summarizes our marks. We can see that the thinnest tree trunk has a diameter 2cm and the largest, 75.9cm.<br />
Finally it tells us the shape and area of our boundary box containing all our points is 200x200m. Note, this bounding box doesn’t <em>have</em> to be rectangular.</li>
</ul>
</div>
<div id="lab-3-challenge-3" class="section level2">
<h2><span class="header-section-number">3.8</span> Lab-3 Challenge 3</h2>
<ol style="list-style-type: decimal">
<li><p>Create a new subheading called global intensity</p></li>
<li><p>Create a new code chunk and use the example above to work out the global intensity of trees in the bei dataset</p></li>
</ol>
</div>
<div id="local-intensity---quadrat-analysis" class="section level2">
<h2><span class="header-section-number">3.9</span> Local intensity - quadrat analysis</h2>
<p>Instead of a single number for intensity, we can examine how the point density varies across the study area. The simplest way to do this is by a technique called <em>quadrat analysis</em>. To do this we will:</p>
<ol style="list-style-type: decimal">
<li>Divide the region into a series of equally sized quadrats/rectangles</li>
<li>Calculate the intensity of the point process in each quadrat, to see how it varies</li>
</ol>
<p>This can be done in R using the quadratcount command from the spatstat package.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="lab-3.html#cb78-1"></a>Q &lt;-<span class="st"> </span><span class="kw">quadratcount</span>(longleaf, <span class="dt">nx =</span> <span class="dv">4</span>, <span class="dt">ny =</span> <span class="dv">4</span>)</span>
<span id="cb78-2"><a href="lab-3.html#cb78-2"></a><span class="kw">print</span>(Q)</span></code></pre></div>
<pre><code>##            x
## y           [0,50) [50,100) [100,150) [150,200]
##   [150,200]     34       49        25        36
##   [100,150)     34       48        78        46
##   [50,100)      43       26        37        47
##   [0,50)        33       18        15        15</code></pre>
<p>The above command divides the longleaf dataset in 16 equally sized square grid-cells, or quadrats. I have specified 4 quadrats in the x direction and 4 in the y direction. It then returns a count of the number of points in each quadrat as well as the size of each quadrat.</p>
<p>In this case we can see that the area is 50*50 = 2500m</p>
<p>The above data is for counts, so we can either divide each value by 2500 or simply use the intensity command to print the intensity:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="lab-3.html#cb80-1"></a><span class="co"># Print the density for each quadrat</span></span>
<span id="cb80-2"><a href="lab-3.html#cb80-2"></a><span class="co"># This is literally the counts in each box divided by the area of each box, 2500m^2</span></span>
<span id="cb80-3"><a href="lab-3.html#cb80-3"></a><span class="kw">intensity</span>(Q)</span></code></pre></div>
<pre><code>##            x
## y           [0,50) [50,100) [100,150) [150,200]
##   [150,200] 0.0136   0.0196    0.0100    0.0144
##   [100,150) 0.0136   0.0192    0.0312    0.0184
##   [50,100)  0.0172   0.0104    0.0148    0.0188
##   [0,50)    0.0132   0.0072    0.0060    0.0060</code></pre>
<p>We can also plot this to make it easier to interpret:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="lab-3.html#cb82-1"></a><span class="kw">plot</span>(longleaf,           <span class="co"># I&#39;m plotting the longleaf data</span></span>
<span id="cb82-2"><a href="lab-3.html#cb82-2"></a>     <span class="dt">use.marks =</span> F,      <span class="co"># I didn&#39;t want it to plot the different circle sizes so i turned off marks</span></span>
<span id="cb82-3"><a href="lab-3.html#cb82-3"></a>     <span class="dt">cex =</span> <span class="fl">0.5</span>, <span class="dt">pch =</span> <span class="dv">4</span>, <span class="co"># point size and shape    </span></span>
<span id="cb82-4"><a href="lab-3.html#cb82-4"></a>     <span class="dt">main=</span><span class="st">&quot;Longleaf quadrat count&quot;</span>) <span class="co"># plot title</span></span>
<span id="cb82-5"><a href="lab-3.html#cb82-5"></a></span>
<span id="cb82-6"><a href="lab-3.html#cb82-6"></a>Q &lt;-<span class="st"> </span><span class="kw">quadratcount</span>(longleaf, <span class="dt">nx =</span> <span class="dv">4</span>, <span class="dt">ny =</span> <span class="dv">4</span>)  <span class="co"># Calculate the quadrat counts.</span></span>
<span id="cb82-7"><a href="lab-3.html#cb82-7"></a><span class="kw">plot</span>(Q, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="dv">2</span>)  <span class="co"># Now I add Q on top.</span></span></code></pre></div>
<p><img src="GEOG364Labs_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>I can see the there are 15 points in the bottom right quadrat compared to 34 in the top left. In future labs, we will assess if this variation is statistically significant.</p>
<p>Or we can also plot the intensity, because the colours make it simpler to see patterns.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="lab-3.html#cb83-1"></a><span class="co"># Plot the intensity</span></span>
<span id="cb83-2"><a href="lab-3.html#cb83-2"></a><span class="kw">plot</span>(<span class="kw">intensity</span>(Q, <span class="dt">image=</span><span class="ot">TRUE</span>), <span class="dt">main=</span><span class="st">&quot;Point intensity&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)  <span class="co"># Plot intensity raster </span></span>
<span id="cb83-3"><a href="lab-3.html#cb83-3"></a><span class="kw">plot</span>(longleaf, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="fl">0.6</span>,  <span class="dt">add=</span><span class="ot">TRUE</span>)                     <span class="co"># Add points</span></span></code></pre></div>
<p><img src="GEOG364Labs_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>Finally, I am going to calculate the Variance Mean Ratio, which gives an assessment about whether the data is clustered, uniform or random (AKA levels of spatial autocorrelation):</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="lab-3.html#cb84-1"></a><span class="co"># we use the as vector command to convert the data from a spatial ppp object back to a normal number</span></span>
<span id="cb84-2"><a href="lab-3.html#cb84-2"></a>longleaf.variance &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">as.vector</span>(Q)) </span>
<span id="cb84-3"><a href="lab-3.html#cb84-3"></a>longleaf.mean &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">as.vector</span>(Q))</span>
<span id="cb84-4"><a href="lab-3.html#cb84-4"></a></span>
<span id="cb84-5"><a href="lab-3.html#cb84-5"></a>longleaf.VMR &lt;-<span class="st"> </span>longleaf.variance <span class="op">/</span><span class="st"> </span>longleaf.mean</span>
<span id="cb84-6"><a href="lab-3.html#cb84-6"></a><span class="kw">print</span>(longleaf.VMR)</span></code></pre></div>
<pre><code>## [1] 6.918721</code></pre>
<p>Overall, does this show the data is clustered or not?</p>
</div>
<div id="lab-3-challenge-4" class="section level2">
<h2><span class="header-section-number">3.10</span> Lab-3 Challenge 4</h2>
<ol style="list-style-type: decimal">
<li><p>Create a new subheading called quadrat analysis</p></li>
<li><p>Follow the example above, but replacing longleaf with bei - to create a quadrat analysis for the bei data. You should include:</p></li>
</ol>
<ul>
<li>A table of counts</li>
<li>A table of intensities</li>
<li>A plot of counts</li>
<li>A plot of intensities</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Calculate the Variance Mean Ratio for the bei data.</li>
</ol>
<p>You will need these to answer questions in the Lab 3 quiz.</p>
</div>
<div id="issues-with-quadrat-analysis" class="section level2">
<h2><span class="header-section-number">3.11</span> Issues with quadrat analysis</h2>
<p>Quadrat analysis is susceptible to some major spatial fallacies and problems. As described in the mgimond e-text-book:</p>
<p><em>“The choice of quadrat shape and size will influence the measure of local density and must be chosen with care. If very small quadrat sizes are used you risk having many quadrats with no points which may prove uninformative. If very large quadrat sizes are used, you risk missing subtle changes in spatial density distributions.”</em></p>
<p>For example, changing the quadrat box size affects the strength of the north-west / south-east gradient we see here. Equally, there are clear clusters in the underlying data and analysis hasn’t really captured those at all.</p>
<p>I want to explore the impact of changing quadrat size with the longleaf data.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="lab-3.html#cb86-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dt">row=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">3</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>)) <span class="co"># set up 3 subplots in a row </span></span>
<span id="cb86-2"><a href="lab-3.html#cb86-2"></a></span>
<span id="cb86-3"><a href="lab-3.html#cb86-3"></a><span class="co"># 2 x 2 gridcells</span></span>
<span id="cb86-4"><a href="lab-3.html#cb86-4"></a>Q.A &lt;-<span class="st"> </span><span class="kw">quadratcount</span>(longleaf, <span class="dt">nx =</span> <span class="dv">2</span>, <span class="dt">ny =</span> <span class="dv">2</span>)                   <span class="co"># Split into 2x2 quadrats</span></span>
<span id="cb86-5"><a href="lab-3.html#cb86-5"></a></span>
<span id="cb86-6"><a href="lab-3.html#cb86-6"></a><span class="kw">plot</span>(<span class="kw">intensity</span>(Q.A, <span class="dt">image=</span><span class="ot">TRUE</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)                <span class="co"># Plot intensity raster</span></span>
<span id="cb86-7"><a href="lab-3.html#cb86-7"></a><span class="kw">plot</span>(longleaf, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="fl">0.6</span>, <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>), <span class="dt">add=</span><span class="ot">TRUE</span>)    <span class="co"># Add longleaf points</span></span>
<span id="cb86-8"><a href="lab-3.html#cb86-8"></a><span class="kw">plot</span>(Q.A, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;white&quot;</span>,<span class="dt">font=</span><span class="dv">2</span>)               <span class="co"># Add numbers</span></span>
<span id="cb86-9"><a href="lab-3.html#cb86-9"></a></span>
<span id="cb86-10"><a href="lab-3.html#cb86-10"></a><span class="co">####</span></span>
<span id="cb86-11"><a href="lab-3.html#cb86-11"></a></span>
<span id="cb86-12"><a href="lab-3.html#cb86-12"></a><span class="co"># 4 x 4 gridcells</span></span>
<span id="cb86-13"><a href="lab-3.html#cb86-13"></a>Q.B &lt;-<span class="st"> </span><span class="kw">quadratcount</span>(longleaf, <span class="dt">nx =</span> <span class="dv">4</span>, <span class="dt">ny =</span> <span class="dv">4</span>)                   <span class="co"># Split into 4x4 quadrats</span></span>
<span id="cb86-14"><a href="lab-3.html#cb86-14"></a></span>
<span id="cb86-15"><a href="lab-3.html#cb86-15"></a><span class="kw">plot</span>(<span class="kw">intensity</span>(Q.B, <span class="dt">image=</span><span class="ot">TRUE</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)                <span class="co"># Plot intensity raster</span></span>
<span id="cb86-16"><a href="lab-3.html#cb86-16"></a><span class="kw">plot</span>(longleaf, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="fl">0.6</span>, <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>), <span class="dt">add=</span><span class="ot">TRUE</span>  )  <span class="co"># Add longleaf points</span></span>
<span id="cb86-17"><a href="lab-3.html#cb86-17"></a><span class="kw">plot</span>(Q.B, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;white&quot;</span>,<span class="dt">font=</span><span class="dv">2</span>)               <span class="co"># Add numbers</span></span>
<span id="cb86-18"><a href="lab-3.html#cb86-18"></a></span>
<span id="cb86-19"><a href="lab-3.html#cb86-19"></a><span class="co">####</span></span>
<span id="cb86-20"><a href="lab-3.html#cb86-20"></a></span>
<span id="cb86-21"><a href="lab-3.html#cb86-21"></a><span class="co"># 12 x 3 gridcells</span></span>
<span id="cb86-22"><a href="lab-3.html#cb86-22"></a>Q.C &lt;-<span class="st"> </span><span class="kw">quadratcount</span>(longleaf, <span class="dt">nx =</span> <span class="dv">12</span>, <span class="dt">ny =</span> <span class="dv">3</span>)                  <span class="co"># Split into 12 x 3 quadrats</span></span>
<span id="cb86-23"><a href="lab-3.html#cb86-23"></a></span>
<span id="cb86-24"><a href="lab-3.html#cb86-24"></a><span class="kw">plot</span>(<span class="kw">intensity</span>(Q.C, <span class="dt">image=</span><span class="ot">TRUE</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)               <span class="co"># Plot intensity raster</span></span>
<span id="cb86-25"><a href="lab-3.html#cb86-25"></a><span class="kw">plot</span>(longleaf, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="fl">0.6</span>, <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>), <span class="dt">add=</span><span class="ot">TRUE</span>)   <span class="co"># Add longleaf points</span></span>
<span id="cb86-26"><a href="lab-3.html#cb86-26"></a><span class="kw">plot</span>(Q.C, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;white&quot;</span>,<span class="dt">font=</span><span class="dv">2</span>)              <span class="co"># Add numbers</span></span></code></pre></div>
<p><img src="GEOG364Labs_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>One final important note for quadrat analysis, is that it is typically good to keep the numbers IN EACH QUADRAT to be at least 30. Otherwise you have an even higher likelihood of seeing patterns just by random chance.</p>
</div>
<div id="lab-3-challenge-5" class="section level2">
<h2><span class="header-section-number">3.12</span> Lab-3 Challenge 5</h2>
<ol style="list-style-type: decimal">
<li><p>Create a new code chunk, then copy and paste the code above into it. Replace all the longleafs with bei (there are 6 instances) and run to check it works</p></li>
<li><p>Now, modify the code chunk to:</p></li>
</ol>
<ul>
<li>Make your subplots in 1 column but in 3 rows (e.g. arranged vertically)</li>
<li>plot quadrat counts for
<ul>
<li>4 quadrats (2 in the x direction and 2 in the y direction),</li>
<li>20 quadrats (5 in the x direction and 4 in the y direction),</li>
<li>100 quadrats (10x10)</li>
</ul></li>
</ul>
<p>Below the code chunk, write about the features you observe when modifying the number of quadrats for the bei data. This is a classic example of a spatial fallacy. Which one and why?</p>
</div>
<div id="kernel-density-estimation-kde" class="section level2">
<h2><span class="header-section-number">3.13</span> Kernel Density Estimation (KDE)</h2>
<p>Kernel Density Estimation is another method that we can use to explore point pattern densities. As described in <a href="https://sites.warnercnr.colostate.edu/wtinkham/courses-taught/nr-512-spatial-statistical-modeling/nr-512-exercise-descriptions/nr-512-exercise-3/" class="uri">https://sites.warnercnr.colostate.edu/wtinkham/courses-taught/nr-512-spatial-statistical-modeling/nr-512-exercise-descriptions/nr-512-exercise-3/</a>,</p>
<p><em>"Quadrat counting is useful for characterizing the intensity of an inhomogeneous point process, however there are limitations including:</em></p>
<p>– <em>The choice of origin, quadrat orientation, and quadrat size affects the observed frequency distribution.</em>
– <em>A significant amount of spatial data is lost.</em></p>
<p><em>KDE algorithms use a moving window approach to characterize intensity. This approach tends to preserve a greater amount of spatial detail and does not suffer as much from choices of origin, quadrat orientation, and quadrat size as compared to quadrat counting."</em></p>
<p>Conceptually, a smoothly curved surface is fitted over each point. The surface value is highest at the location of the point and diminishes with increasing distance from the point. There will be more about this in the lectures.</p>
<p>To apply it in R, we simply use the density command. For example, for the longleaf data, I would create a new code chunk and type.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="lab-3.html#cb87-1"></a>PointDensity &lt;-<span class="st"> </span><span class="kw">density</span>(longleaf)</span>
<span id="cb87-2"><a href="lab-3.html#cb87-2"></a><span class="kw">plot</span>(PointDensity)</span>
<span id="cb87-3"><a href="lab-3.html#cb87-3"></a></span>
<span id="cb87-4"><a href="lab-3.html#cb87-4"></a><span class="co"># Individual events can be added to the plot by adding our original points to the plot.</span></span>
<span id="cb87-5"><a href="lab-3.html#cb87-5"></a> <span class="kw">plot</span>(longleaf, <span class="dt">add =</span> <span class="ot">TRUE</span>,</span>
<span id="cb87-6"><a href="lab-3.html#cb87-6"></a>      <span class="dt">use.marks =</span> F, <span class="dt">cex =</span> <span class="fl">0.5</span>,<span class="dt">pch=</span><span class="dv">16</span>) <span class="co"># i&#39;m ignoring the tree diameters and want small filled dots</span></span></code></pre></div>
<p><img src="GEOG364Labs_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<p>So you can see that instead of quadrats, we now have a smooth surface.</p>
<p>In the density command above, the size &amp; shape of the smoothing window, (known as the “bandwidth”) is calculated automatically using a ‘rule of thumb’. It defaults to 0.9 times the minimum of the standard deviation and the interquartile range divided by 1.34 times the sample size to the negative one-fifth power.</p>
<p>However, the bandwidth can be scaled via the sigma parameter within the density command:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="lab-3.html#cb88-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dt">row=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">3</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># set up 3 subplots in a row</span></span>
<span id="cb88-2"><a href="lab-3.html#cb88-2"></a></span>
<span id="cb88-3"><a href="lab-3.html#cb88-3"></a><span class="kw">plot</span> (<span class="kw">density</span>(longleaf, <span class="dt">sigma =</span> <span class="dv">5</span>, <span class="co"># change bandwidth by altering the value assigned to sigma</span></span>
<span id="cb88-4"><a href="lab-3.html#cb88-4"></a>              <span class="dt">main=</span><span class="st">&quot;Bandwidth=5&quot;</span>))</span>
<span id="cb88-5"><a href="lab-3.html#cb88-5"></a><span class="kw">plot</span>(longleaf, <span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">use.marks =</span> F, <span class="dt">cex =</span> <span class="fl">0.5</span>,<span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb88-6"><a href="lab-3.html#cb88-6"></a></span>
<span id="cb88-7"><a href="lab-3.html#cb88-7"></a><span class="kw">plot</span> (<span class="kw">density</span>(longleaf, <span class="dt">sigma =</span> <span class="dv">20</span>, <span class="co"># change bandwidth by altering the value assigned to sigma</span></span>
<span id="cb88-8"><a href="lab-3.html#cb88-8"></a>              <span class="dt">main=</span><span class="st">&quot;Bandwidth=20&quot;</span>))</span>
<span id="cb88-9"><a href="lab-3.html#cb88-9"></a><span class="kw">plot</span>(longleaf, <span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">use.marks =</span> F, <span class="dt">cex =</span> <span class="fl">0.5</span>,<span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb88-10"><a href="lab-3.html#cb88-10"></a></span>
<span id="cb88-11"><a href="lab-3.html#cb88-11"></a><span class="kw">plot</span> (<span class="kw">density</span>(longleaf, <span class="dt">sigma =</span> <span class="dv">100</span>, <span class="co"># change bandwidth by altering the value assigned to sigma</span></span>
<span id="cb88-12"><a href="lab-3.html#cb88-12"></a>              <span class="dt">main=</span><span class="st">&quot;Bandwidth=100&quot;</span>))</span>
<span id="cb88-13"><a href="lab-3.html#cb88-13"></a><span class="kw">plot</span>(longleaf, <span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">use.marks =</span> F, <span class="dt">cex =</span> <span class="fl">0.5</span>,<span class="dt">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="GEOG364Labs_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
</div>
<div id="lab-3-challenge-6" class="section level2">
<h2><span class="header-section-number">3.14</span> Lab-3 Challenge 6</h2>
<ol style="list-style-type: decimal">
<li><p>Create a new sub-heading called Kernel Density Estimation</p></li>
<li><p>Use the example above to run KDE for the bei data and try modifying the bandwidth using the following numbers: 5, 10, 30, 70, 100, 200. (you just have to edit the bandwidth and discuss the result. YOu do not have to show all 7)</p></li>
<li><p>Below the code chunk, write what impact modifying the bandwidth has on your results. What happens at very low vs very high bandwidths?</p></li>
</ol>
<p>4.What is the “best” bandwidth? Make sure your plot shows your final choice Why did you choose that number?</p>
</div>
<div id="automatically-calculating-an-optimal-bandwidth" class="section level2">
<h2><span class="header-section-number">3.15</span> Automatically calculating an “optimal” bandwidth</h2>
<p>Different statisticians have come up with different ways to automatically calculate the “optimal” bandwidth. For example
1. <code>bw.diggle()</code> - minimizes the mean-square error criterion defined by Diggle (1985)
2. <code>bw.frac()</code> - uses a quantile of the distance between two independent random points in the window 3. 3. 3. <code>bw.stoyan()</code> - sets the standard deviation of the kernel</p>
<p>You can look at the R help to understand in more detail how they work (e.g. type ?bw.diggle into your console)</p>
<p>Here I will apply the diggle() function to estimate a bandwidth for the data</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="lab-3.html#cb89-1"></a><span class="co"># Report the value of the bandwidth</span></span>
<span id="cb89-2"><a href="lab-3.html#cb89-2"></a>optimal_diggle &lt;-<span class="st"> </span><span class="kw">bw.diggle</span>(longleaf)</span>
<span id="cb89-3"><a href="lab-3.html#cb89-3"></a></span>
<span id="cb89-4"><a href="lab-3.html#cb89-4"></a><span class="co"># do the density plot</span></span>
<span id="cb89-5"><a href="lab-3.html#cb89-5"></a><span class="kw">plot</span> (<span class="kw">density</span>(longleaf, </span>
<span id="cb89-6"><a href="lab-3.html#cb89-6"></a>              <span class="dt">sigma =</span> optimal_diggle), <span class="co"># use the diggle function to automatically guess bandwidth</span></span>
<span id="cb89-7"><a href="lab-3.html#cb89-7"></a>              <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Diggle Bandwidth Estimation = &quot;</span>,<span class="kw">round</span>(optimal_diggle,<span class="dv">3</span>)))</span>
<span id="cb89-8"><a href="lab-3.html#cb89-8"></a></span>
<span id="cb89-9"><a href="lab-3.html#cb89-9"></a><span class="kw">plot</span>(longleaf, <span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">use.marks =</span> F, <span class="dt">cex =</span> <span class="fl">0.5</span>,<span class="dt">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="GEOG364Labs_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
<div id="lab-3-challenge-7" class="section level2">
<h2><span class="header-section-number">3.16</span> Lab-3 Challenge 7</h2>
<p>Apply the code above to your script to calculate and plot an “optimal” bandwidth for the bei data.</p>
<p>Finally, reflect on the lab and look back at the outputs you have made. If someone asks you about the spatial distribution of trees in the area, what would you tell them and which plots and analyses would you use (or not use!) to provide evidence. Write your thoughts below the code chunk.</p>
</div>
<div id="lab-3-show-me-something-new" class="section level2">
<h2><span class="header-section-number">3.17</span> Lab-3 Show me something new</h2>
<p>Make a new sub-heading called Something new.</p>
<p>You have three options this week:</p>
<p>A - You can show me some minor additions to existing code for 2.5/5 marks. For example:</p>
<ul>
<li>Showing me you know how to do some new markdown format (tables, links - see here for inspiration: <a href="https://www.statpower.net/Content/310/R%20Stuff/SampleMarkdown.html" class="uri">https://www.statpower.net/Content/310/R%20Stuff/SampleMarkdown.html</a>)</li>
<li>Adding a new minor YAML element (you will have to do this at the top and describe what you did here)</li>
<li>Adding contours to the Kernel density data using a command such as
<ul>
<li>contour(density(bei), add=TRUE, col = “white”)</li>
</ul></li>
<li>Create a 2x2 grid of plots or add a new plotting format.</li>
</ul>
<p>B - For 5/5 you need to demonstrates the use of a function or package that was not specifically covered in the handout, lecture, or lab. For example:</p>
<ul>
<li>Adding a new colour palette from somewhere like R colorbrewer to your Kernel Density plots</li>
<li>Adding country or regional borders to these plots</li>
<li>Add a paragraph where you explain quadrat and/or kernel density and properly include equations using the R markdown equation format. E.g. they should look like mathematical equations in a text book.</li>
<li>Reading/loading in a new point pattern, converting to ppp and running one analysis on it</li>
<li>Do something with a completely new package or function</li>
<li>Delve into some of the more complexities of the analysis - <a href="https://mgimond.github.io/Spatial/point-pattern-analysis.html#local-density" class="uri">https://mgimond.github.io/Spatial/point-pattern-analysis.html#local-density</a></li>
<li>Apply one of the other optimal bandwidths to the KDE data e.g. bw.frac or bw.stoyan</li>
</ul>
<p>C - For 5/5, complete an optional extra extension to this work where we use quadrat analysis to assess whether elevation impacts the bei data.</p>
<p>Go to this link: <a href="https://sites.warnercnr.colostate.edu/wtinkham/courses-taught/nr-512-spatial-statistical-modeling/nr-512-exercise-descriptions/nr-512-exercise-3/" class="uri">https://sites.warnercnr.colostate.edu/wtinkham/courses-taught/nr-512-spatial-statistical-modeling/nr-512-exercise-descriptions/nr-512-exercise-3/</a></p>
<p>Then scroll down to the end where it says: “In the quadrat counting example above, we used a series of equally sized quadrats to characterize the intensity of a ppp object. In quadrat counting methods, any choice of quadrats is permissible. From a theoretical viewpoint, the quadrats do not have to be rectangles of equal area, instead they could be regions of any shape. Quadrat counting is more useful if we choose the quadrats in a meaningful way. One way to do this is to define the quadrats using covariate information.”</p>
<p>Work from that point onward to show how quadrat analysis can be used to link a variable such as elevation to your point pattern.</p>
</div>
<div id="lab-3-submission-check" class="section level2">
<h2><span class="header-section-number">3.18</span> Lab-3 submission check</h2>
<p><strong>HTML FILE SUBMISSION - 5 marks</strong></p>
<p><strong>RMD CODE SUBMISSION - 5 marks</strong></p>
<p><strong>LAB CHALLENGE 1 to 4 - 10 marks total</strong></p>
<p>You included all the requested code/analysis and your code runs for the BEI data (not the longleaf data!)</p>
<p><strong>LAB CHALLENGE 5 - 10 marks</strong></p>
<p>You thoughtfully explored the impact of changing the quadrat size and shape on the bei data, providing the requested code and outputs.</p>
<p><strong>LAB CHALLENGE 6 - 10 marks</strong></p>
<p>You chose your best bandwidth for the bei data, showed it on your plot and justified your choice.</p>
<p><strong>LAB CHALLENGE 7 - 10 marks</strong></p>
<p>You calculated an optimal bandwidth for the data and included a thoughtful, well organized, and articulated response to your reflections on the lab.</p>
<p><strong>SOMETHING NEW - 5 marks</strong></p>
<p>You made a minor change to an existing piece of code (2.5/5)
OR
You demonstrated the use of a function or concept that was not specifically covered in the handout, lecture, or lab (5/5)</p>
<p><strong>MARKDOWN/CODE STYLE - 5 MARKS</strong></p>
<p>Your code and document is neat and easy to read. You have section headings, have clearly labeled your answers or described what you are trying to do in the code.</p>
<p>[60 marks total]
<strong>THERE IS A CANVAS QUIZ WITH THIS LAB FOR THE OTHER 40 MARKS</strong></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lab-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="test-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-Lab03.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["GEOG364Labs.pdf", "GEOG364Labs.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
